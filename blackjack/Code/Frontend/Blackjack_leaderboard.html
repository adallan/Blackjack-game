<html>
    <head>
        <title> Blackjack Leaderboard</title>
        <style>
            body{
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                text-align: center;
                background-image:url(Blackjack-assets/casino-table_background.png);
                background-size:cover;
                background-position:center;
                height: 100vh;
                width: 100vw;
                margin: 0;
                padding: 0;
                overflow: hidden;
                background-repeat: no-repeat;
                min-height: 100vh;
                width: 100%;
                font-family: 'Playfair Display', serif;
                color: white;
                font-size: 2vh;
            }
            h1 {
                background: linear-gradient(90deg, gold, white, gold);
                background-size: 200%;
                -webkit-background-clip: text;
                color: transparent;
                animation: shine 3s linear infinite;
            }
            @keyframes shine {
                0% { background-position: 200%; }
                100% { background-position: -200%; }
            }
            #leaderboard_table {
                width: 80%;
                max-width: 1000px;
                margin: 2rem auto;
                border-collapse: collapse;
                font-family: 'Playfair Display', serif;
                color: white;
                font-size: 1.8vh; 
                text-align: center;
                background-color: rgba(0, 0, 0, 0.5); 
                border-radius: 10px;
                overflow: hidden;
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.6); 
            }

            /* Table headers */
            #leaderboard_table th {
                background: linear-gradient(90deg, gold, #ffd700, gold);
                color: black;
                font-size: 2vh;
                padding: 10px;
                text-transform: uppercase;
                letter-spacing: 1px;
            }

            /* Table rows */
            #leaderboard_table tr {
                transition: background 0.3s, transform 0.2s;
            }

            /* Alternating row colors for readability */
            #leaderboard_table tr:nth-child(even) {
                background-color: rgba(255, 255, 255, 0.05);
            }

            /* Hover effect */
            #leaderboard_table tr:hover {
                background-color: rgba(255, 215, 0, 0.2); /* soft gold highlight */
                transform: scale(1.01);
            }

            /* Table cells */
            #leaderboard_table td {
                padding: 12px;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }

            /* Highlight the top 3 ranks */
            #leaderboard_table tr:first-child td:nth-child(1),
            #leaderboard_table tr:nth-child(2) td:nth-child(1),
            #leaderboard_table tr:nth-child(3) td:nth-child(1) {
                color: gold;
                font-weight: bold;
                text-shadow: 0 0 5px gold;
            }

            /* Responsive font scaling for mobile */
            @media (max-width: 768px) {
                #leaderboard_table {
                    font-size: 2.5vw;
                }
                #leaderboard_table th, #leaderboard_table td {
                    padding: 8px;
                }
            }
        </style>
    </head>
    <body>
        <h1> Blackjack Leaderboard</h1>
        <table id="leaderboard_table">
            <tr>
                <th> Rank </th>
                <th> Username </th>
                <th> Highest Chips </th>
                <th> Wins </th>
                <th> Games Played </th>
                <th> Win Rate </th>
            </tr>
            <script>
                async function loadLeaderboard() {
                    try {
                        // Fetch leaderboard from backend
                        const response = await fetch("https://uexoocaysoxxcplbcgly.supabase.co/functions/v1/leaderboard", {
                        method: "GET",
                        headers: { 
                            "Content-Type": "application/json",
                            "Authorization": "Bearer sb_publishable_fyQczZnLTyEE_fU2CMRjMw_wkrw19cU",
                            "apikey": "sb_publishable_fyQczZnLTyEE_fU2CMRjMw_wkrw19cU"
                        }
                        });
                        const data = await response.json();

                        const table = document.getElementById("leaderboard_table");

                        // Loop through each player and create a row
                        data.leaderboard.forEach(player => {
                            const row = document.createElement("tr");

                            row.innerHTML = `
                                <td>${player.rank}</td>
                                <td>${player.username}</td>
                                <td>${player.max_chips}</td>
                                <td>${player.wins}</td>
                                <td>${player.hands_played}</td>
                                <td>${player.win_rate}%</td>
                            `;

                            table.appendChild(row);
                        });

                    } catch (err) {
                        console.error("Failed to load leaderboard:", err);
                    }
                }

                // Load leaderboard when page loads
                window.addEventListener("DOMContentLoaded", loadLeaderboard);
            </script>
        </table>
    </body>
</html>